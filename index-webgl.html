<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dance & Enrobe - Psychedelic Flow</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&display=swap');
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0a0608; color: #fff; font-family: 'Cormorant Garamond', Georgia, serif; min-height: 100vh; overflow-x: hidden; }
        .header { background: linear-gradient(180deg, rgba(114,47,55,0.9) 0%, rgba(10,6,8,0.95) 100%); padding: 15px 25px; text-align: center; border-bottom: 2px solid rgba(212,175,55,0.6); }
        .header h1 { font-family: 'Cinzel', serif; font-size: 1.4rem; color: #d4af37; letter-spacing: 4px; text-transform: uppercase; }
        .header-sub { font-size: 0.85rem; color: #f4e4ba; margin-top: 4px; letter-spacing: 2px; }
        .latency-badge { display: inline-block; background: linear-gradient(90deg, #2a5a2a, #4a8a4a); color: #90EE90; padding: 4px 12px; border-radius: 20px; font-size: 0.7rem; font-family: 'Cinzel', serif; margin-top: 8px; }
        .main { display: grid; grid-template-columns: 320px 1fr; gap: 20px; padding: 20px; max-width: 1600px; margin: 0 auto; }
        .controls { background: rgba(15,10,12,0.9); border: 1px solid rgba(212,175,55,0.4); border-radius: 12px; padding: 20px; max-height: calc(100vh - 120px); overflow-y: auto; }
        .section { margin-bottom: 20px; padding-bottom: 18px; border-bottom: 1px solid rgba(212,175,55,0.2); }
        .section:last-child { border-bottom: none; }
        .section h3 { color: #d4af37; font-size: 0.9rem; margin: 0 0 14px 0; font-family: 'Cinzel', serif; letter-spacing: 2px; }
        .slider-row { margin-bottom: 12px; }
        .slider-row label { display: flex; justify-content: space-between; font-size: 0.85rem; margin-bottom: 6px; color: rgba(244,228,186,0.9); }
        .slider-row .val { color: #d4af37; font-weight: 700; }
        input[type="range"] { width: 100%; height: 6px; border-radius: 3px; background: linear-gradient(90deg, #722f37, #d4af37); -webkit-appearance: none; cursor: pointer; }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 18px; height: 18px; border-radius: 50%; background: radial-gradient(circle at 30% 30%, #f4e4ba, #d4af37); cursor: pointer; }
        .audio-section { background: rgba(114,47,55,0.2); border: 1px solid rgba(212,175,55,0.3); border-radius: 8px; padding: 12px; margin-top: 12px; }
        .audio-section h4 { color: #d4af37; font-size: 0.8rem; margin-bottom: 10px; font-family: 'Cinzel', serif; }
        .audio-meter { height: 40px; background: rgba(0,0,0,0.5); border-radius: 4px; display: flex; align-items: flex-end; gap: 2px; padding: 4px; }
        .audio-bar { flex: 1; background: linear-gradient(180deg, #ff00ff, #00ffff, #ff0000); border-radius: 2px; min-height: 2px; }
        .output-area { position: relative; }
        .video-container { position: relative; border: 2px solid rgba(212,175,55,0.6); border-radius: 12px; overflow: hidden; background: #000; }
        .video-wrapper { position: relative; width: 100%; aspect-ratio: 16/9; }
        #webcam { display: none; }
        #glCanvas { width: 100%; height: 100%; display: block; }
        .fullscreen-btn { position: absolute; top: 15px; right: 15px; width: 40px; height: 40px; border: 1px solid rgba(212,175,55,0.6); background: rgba(10,6,8,0.8); color: #d4af37; cursor: pointer; border-radius: 6px; font-size: 1.1rem; z-index: 20; }
        .start-btn { width: 100%; padding: 18px; font-family: 'Cinzel', serif; font-size: 1.1rem; letter-spacing: 3px; background: linear-gradient(180deg, #d4af37, #8b6914); color: #0a0608; border: none; border-radius: 8px; cursor: pointer; text-transform: uppercase; margin-bottom: 15px; }
        .start-btn:disabled { opacity: 0.5; }
        @media (max-width: 900px) { .main { grid-template-columns: 1fr; } .output-area { order: -1; } }
    </style>
</head>
<body>
    <div class="header">
        <h1>âšœ Dance & Enrobe âšœ</h1>
        <div class="header-sub">Psychedelic Flow Transformation</div>
        <div class="latency-badge">âš¡ ZERO LATENCY - WebGL</div>
    </div>
    
    <div class="main">
        <div class="controls">
            <button class="start-btn" id="startBtn">Begin Transformation âšœ</button>
            
            <div class="section">
                <h3>âšœ Flow Field</h3>
                <div class="slider-row"><label>Flow Intensity <span class="val" id="flowVal">60%</span></label><input type="range" id="flowSlider" min="0" max="100" value="60"></div>
                <div class="slider-row"><label>Flow Speed <span class="val" id="speedVal">40%</span></label><input type="range" id="speedSlider" min="10" max="100" value="40"></div>
                <div class="slider-row"><label>Turbulence <span class="val" id="turbVal">50%</span></label><input type="range" id="turbSlider" min="0" max="100" value="50"></div>
                <div class="slider-row"><label>Scale <span class="val" id="scaleVal">30%</span></label><input type="range" id="scaleSlider" min="10" max="80" value="30"></div>
            </div>
            
            <div class="section">
                <h3>âšœ Rainbow Swirls</h3>
                <div class="slider-row"><label>Rainbow Intensity <span class="val" id="rainbowVal">80%</span></label><input type="range" id="rainbowSlider" min="0" max="100" value="80"></div>
                <div class="slider-row"><label>Swirl Layers <span class="val" id="layersVal">70%</span></label><input type="range" id="layersSlider" min="20" max="100" value="70"></div>
                <div class="slider-row"><label>Color Speed <span class="val" id="colorSpeedVal">50%</span></label><input type="range" id="colorSpeedSlider" min="10" max="100" value="50"></div>
                <div class="slider-row"><label>Edge Thickness <span class="val" id="edgeThickVal">60%</span></label><input type="range" id="edgeThickSlider" min="10" max="100" value="60"></div>
            </div>
            
            <div class="section">
                <h3>âšœ Colors</h3>
                <div class="slider-row"><label>Magenta Depth <span class="val" id="magentaVal">70%</span></label><input type="range" id="magentaSlider" min="0" max="100" value="70"></div>
                <div class="slider-row"><label>Dark Void <span class="val" id="voidVal">60%</span></label><input type="range" id="voidSlider" min="0" max="100" value="60"></div>
                <div class="slider-row"><label>Webcam Blend <span class="val" id="blendVal">25%</span></label><input type="range" id="blendSlider" min="0" max="100" value="25"></div>
            </div>
            
            <div class="section">
                <h3>âšœ Audio Reactivity</h3>
                <div class="slider-row"><label>Audio Intensity <span class="val" id="audioVal">75%</span></label><input type="range" id="audioSlider" min="0" max="100" value="75"></div>
                <div class="slider-row"><label>Bass â†’ Pulse <span class="val" id="bassVal">80%</span></label><input type="range" id="bassSlider" min="0" max="100" value="80"></div>
                <div class="slider-row"><label>High â†’ Color <span class="val" id="highVal">70%</span></label><input type="range" id="highSlider" min="0" max="100" value="70"></div>
                <div class="audio-section">
                    <h4>ðŸŽµ Live Audio</h4>
                    <div class="audio-meter" id="audioMeter"></div>
                </div>
            </div>
        </div>
        
        <div class="output-area">
            <div class="video-container" id="videoContainer">
                <div class="video-wrapper">
                    <video id="webcam" autoplay muted playsinline></video>
                    <canvas id="glCanvas"></canvas>
                </div>
                <button class="fullscreen-btn" id="fullscreenBtn">â›¶</button>
            </div>
        </div>
    </div>

<script>
let gl, program, webcamTexture, webcam, canvas;
let audioContext, analyser, audioData;
let isRunning = false;
let startTime = Date.now();
let bassLevel = 0, midLevel = 0, highLevel = 0;
let smoothBass = 0, smoothMid = 0, smoothHigh = 0;

let params = {
    flow: 0.6, speed: 0.4, turb: 0.5, scale: 0.3,
    rainbow: 0.8, layers: 0.7, colorSpeed: 0.5, edgeThick: 0.6,
    magenta: 0.7, darkVoid: 0.6, blend: 0.25,
    audio: 0.75, bass: 0.8, high: 0.7
};

const vsSource = `
attribute vec2 a_pos;
attribute vec2 a_uv;
varying vec2 v_uv;
void main() { gl_Position = vec4(a_pos, 0.0, 1.0); v_uv = a_uv; }
`;

const fsSource = `
precision highp float;
varying vec2 v_uv;
uniform sampler2D u_tex;
uniform float u_time;
uniform vec2 u_res;
uniform float u_bass, u_mid, u_high;
uniform float u_flow, u_speed, u_turb, u_scale;
uniform float u_rainbow, u_layers, u_colorSpeed, u_edgeThick;
uniform float u_magenta, u_void, u_blend;
uniform float u_bassMult, u_highMult;

vec3 mod289(vec3 x) { return x - floor(x / 289.0) * 289.0; }
vec4 mod289(vec4 x) { return x - floor(x / 289.0) * 289.0; }
vec4 perm(vec4 x) { return mod289(((x * 34.0) + 1.0) * x); }

float noise(vec3 p) {
    vec3 a = floor(p);
    vec3 d = p - a;
    d = d * d * (3.0 - 2.0 * d);
    vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
    vec4 k1 = perm(b.xyxy);
    vec4 k2 = perm(k1.xyxy + b.zzww);
    vec4 c = k2 + a.zzzz;
    vec4 k3 = perm(c);
    vec4 k4 = perm(c + 1.0);
    vec4 o1 = fract(k3 / 41.0);
    vec4 o2 = fract(k4 / 41.0);
    vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
    vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
    return o4.y * d.y + o4.x * (1.0 - d.y);
}

float fbm(vec3 p) {
    float v = 0.0, a = 0.5;
    for (int i = 0; i < 6; i++) {
        v += a * noise(p);
        p = p * 2.0;
        a *= 0.5;
    }
    return v;
}

vec3 hsv(vec3 c) {
    vec4 K = vec4(1.0, 2.0/3.0, 1.0/3.0, 3.0);
    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
}

void main() {
    vec2 uv = v_uv;
    vec2 p = (uv - 0.5) * 2.0;
    p.x *= u_res.x / u_res.y;
    
    float t = u_time * u_speed * 0.5;
    float pulse = 1.0 + u_bass * u_bassMult * 0.6;
    float sc = u_scale * 4.0 + 1.0;
    
    // Multiple noise layers for organic flow
    float n1 = fbm(vec3(p * sc, t * 0.3));
    float n2 = fbm(vec3(p * sc * 1.3 + 5.0, t * 0.25));
    float n3 = fbm(vec3(p * sc * 0.7 + n1 * u_turb * 2.0, t * 0.35));
    
    // RAINBOW SWIRL LAYERS
    float swirl1 = fbm(vec3(p * 3.0 + vec2(n1, n2) * 2.0, t * 0.4));
    float swirl2 = fbm(vec3(p * 5.0 - vec2(n2, n1) * 1.5, t * 0.3 + 3.14));
    float swirl3 = fbm(vec3(p * 7.0 + vec2(swirl1, swirl2) * u_layers, t * 0.5));
    
    // Edge detection for rainbow placement
    float e1 = length(vec2(dFdx(n3), dFdy(n3))) * 40.0 * u_edgeThick;
    float e2 = length(vec2(dFdx(swirl1), dFdy(swirl1))) * 50.0 * u_edgeThick;
    float e3 = length(vec2(dFdx(swirl2), dFdy(swirl2))) * 45.0 * u_edgeThick;
    float e4 = length(vec2(dFdx(swirl3), dFdy(swirl3))) * 35.0 * u_edgeThick;
    
    // ORNATE RAINBOW COLORS - cycling through full spectrum
    float hue1 = fract(swirl1 * 3.0 + t * u_colorSpeed * 0.4 + u_high * u_highMult * 0.3);
    float hue2 = fract(swirl2 * 2.5 + t * u_colorSpeed * 0.35 + 0.33);
    float hue3 = fract(swirl3 * 2.0 + t * u_colorSpeed * 0.45 + 0.66);
    float hue4 = fract(n3 * 4.0 + t * u_colorSpeed * 0.3);
    
    vec3 rainbow1 = hsv(vec3(hue1, 1.0, 1.0)) * e1;
    vec3 rainbow2 = hsv(vec3(hue2, 0.95, 0.95)) * e2;
    vec3 rainbow3 = hsv(vec3(hue3, 0.9, 1.0)) * e3;
    vec3 rainbow4 = hsv(vec3(hue4, 1.0, 0.9)) * e4;
    
    // Swirling band patterns
    float band1 = smoothstep(0.3, 0.7, fract(swirl1 * 6.0 + t * 0.2)) * e2;
    float band2 = smoothstep(0.4, 0.6, fract(swirl2 * 5.0 - t * 0.15)) * e3;
    float band3 = smoothstep(0.35, 0.65, fract(swirl3 * 7.0 + t * 0.25)) * e1;
    
    vec3 bands = hsv(vec3(fract(t * 0.1 + swirl1), 1.0, 1.0)) * band1 +
                 hsv(vec3(fract(t * 0.12 + swirl2 + 0.33), 1.0, 1.0)) * band2 +
                 hsv(vec3(fract(t * 0.08 + swirl3 + 0.66), 1.0, 1.0)) * band3;
    
    // Combined rainbow swirls
    vec3 allRainbow = (rainbow1 + rainbow2 + rainbow3 + rainbow4 + bands) * u_rainbow * (1.0 + u_high * 0.5);
    
    // Distort UV for webcam sampling
    vec2 distUV = uv + vec2(n1, n2) * u_flow * 0.2 * pulse;
    distUV = clamp(distUV, 0.0, 1.0);
    vec4 cam = texture2D(u_tex, distUV);
    float lum = dot(cam.rgb, vec3(0.3, 0.6, 0.1));
    
    // Organic blob shapes
    float blob = fbm(vec3(p * 2.0, t * 0.2)) * pulse;
    blob = smoothstep(-0.1, 0.6, blob);
    
    // Dark void base
    vec3 voidCol = vec3(0.03, 0.01, 0.05) * (1.0 - u_void * 0.3);
    
    // Magenta/purple tones
    vec3 magenta1 = hsv(vec3(0.83, 0.8, 0.35 * u_magenta));
    vec3 magenta2 = hsv(vec3(0.88, 0.7, 0.25 * u_magenta));
    
    // Build base color
    vec3 col = mix(voidCol, magenta1, blob * 0.6);
    col = mix(col, magenta2, n3 * 0.4);
    
    // ADD THE RAINBOW SWIRLS - this is the key part
    col += allRainbow;
    
    // Iridescent edge glow
    float blobEdge = length(vec2(dFdx(blob), dFdy(blob))) * 80.0;
    vec3 iridescent = hsv(vec3(fract(n1 + n2 + t * 0.3), 0.9, 1.0)) * blobEdge * u_rainbow;
    col += iridescent;
    
    // Blend webcam
    vec3 camTint = cam.rgb * vec3(1.0, 0.7, 0.9);
    col = mix(col, camTint * (0.4 + lum * 0.6), u_blend * blob);
    
    // Audio pulse glow
    col += vec3(0.4, 0.0, 0.3) * u_bass * u_bassMult * 0.25;
    col += allRainbow * u_bass * 0.3;
    
    // Vignette
    col *= 1.0 - length(p) * 0.35;
    
    gl_FragColor = vec4(col, 1.0);
}
`;

function initGL() {
    canvas = document.getElementById('glCanvas');
    gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
    if (!gl) { alert('WebGL not supported'); return false; }
    
    // Enable derivatives for edge detection
    gl.getExtension('OES_standard_derivatives');
    
    const vs = gl.createShader(gl.VERTEX_SHADER);
    gl.shaderSource(vs, vsSource);
    gl.compileShader(vs);
    
    const fs = gl.createShader(gl.FRAGMENT_SHADER);
    gl.shaderSource(fs, '#extension GL_OES_standard_derivatives : enable\n' + fsSource);
    gl.compileShader(fs);
    if (!gl.getShaderParameter(fs, gl.COMPILE_STATUS)) {
        console.error('Fragment shader error:', gl.getShaderInfoLog(fs));
    }
    
    program = gl.createProgram();
    gl.attachShader(program, vs);
    gl.attachShader(program, fs);
    gl.linkProgram(program);
    
    const pos = new Float32Array([-1,-1, 1,-1, -1,1, 1,1]);
    const uv = new Float32Array([0,1, 1,1, 0,0, 1,0]);
    
    const posBuf = gl.createBuffer();
    gl.bindBuffer(gl.ARRAY_BUFFER, posBuf);
    gl.bufferData(gl.ARRAY_BUFFER, pos, gl.STATIC_DRAW);
    const posLoc = gl.getAttribLocation(program, 'a_pos');
    gl.enableVertexAttribArray(posLoc);
    gl.vertexAttribPointer(posLoc, 2, gl.FLOAT, false, 0, 0);
    
    const uvBuf = gl.createBuffer();
    gl.bindBuffer(gl.ARRAY_BUFFER, uvBuf);
    gl.bufferData(gl.ARRAY_BUFFER, uv, gl.STATIC_DRAW);
    const uvLoc = gl.getAttribLocation(program, 'a_uv');
    gl.enableVertexAttribArray(uvLoc);
    gl.vertexAttribPointer(uvLoc, 2, gl.FLOAT, false, 0, 0);
    
    webcamTexture = gl.createTexture();
    gl.bindTexture(gl.TEXTURE_2D, webcamTexture);
    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);
    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);
    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
    
    return true;
}

function initAudio(stream) {
    try {
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
        analyser = audioContext.createAnalyser();
        analyser.fftSize = 256;
        analyser.smoothingTimeConstant = 0.8;
        const src = audioContext.createMediaStreamSource(stream);
        src.connect(analyser);
        audioData = new Uint8Array(analyser.frequencyBinCount);
        
        const meter = document.getElementById('audioMeter');
        meter.innerHTML = '';
        for (let i = 0; i < 32; i++) {
            const bar = document.createElement('div');
            bar.className = 'audio-bar';
            meter.appendChild(bar);
        }
    } catch(e) { console.error('Audio error:', e); }
}

function updateAudio() {
    if (!analyser) return;
    analyser.getByteFrequencyData(audioData);
    const n = audioData.length;
    const bassEnd = Math.floor(n * 0.15);
    const midEnd = Math.floor(n * 0.5);
    let b = 0, m = 0, h = 0;
    for (let i = 0; i < n; i++) {
        const v = audioData[i] / 255;
        if (i < bassEnd) b += v;
        else if (i < midEnd) m += v;
        else h += v;
    }
    bassLevel = (b / bassEnd) * params.audio;
    midLevel = (m / (midEnd - bassEnd)) * params.audio;
    highLevel = (h / (n - midEnd)) * params.audio;
    smoothBass = smoothBass * 0.7 + bassLevel * 0.3;
    smoothMid = smoothMid * 0.8 + midLevel * 0.2;
    smoothHigh = smoothHigh * 0.85 + highLevel * 0.15;
    
    const bars = document.querySelectorAll('.audio-bar');
    const step = Math.floor(n / bars.length);
    bars.forEach((bar, i) => {
        bar.style.height = Math.max(2, audioData[i * step] / 255 * 36) + 'px';
    });
}

function render() {
    if (!isRunning) return;
    updateAudio();
    
    const t = (Date.now() - startTime) / 1000;
    canvas.width = webcam.videoWidth || 1280;
    canvas.height = webcam.videoHeight || 720;
    gl.viewport(0, 0, canvas.width, canvas.height);
    
    gl.bindTexture(gl.TEXTURE_2D, webcamTexture);
    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, webcam);
    
    gl.useProgram(program);
    
    const u = (name) => gl.getUniformLocation(program, name);
    gl.uniform1f(u('u_time'), t);
    gl.uniform2f(u('u_res'), canvas.width, canvas.height);
    gl.uniform1f(u('u_bass'), smoothBass);
    gl.uniform1f(u('u_mid'), smoothMid);
    gl.uniform1f(u('u_high'), smoothHigh);
    gl.uniform1f(u('u_flow'), params.flow);
    gl.uniform1f(u('u_speed'), params.speed);
    gl.uniform1f(u('u_turb'), params.turb);
    gl.uniform1f(u('u_scale'), params.scale);
    gl.uniform1f(u('u_rainbow'), params.rainbow);
    gl.uniform1f(u('u_layers'), params.layers);
    gl.uniform1f(u('u_colorSpeed'), params.colorSpeed);
    gl.uniform1f(u('u_edgeThick'), params.edgeThick);
    gl.uniform1f(u('u_magenta'), params.magenta);
    gl.uniform1f(u('u_void'), params.darkVoid);
    gl.uniform1f(u('u_blend'), params.blend);
    gl.uniform1f(u('u_bassMult'), params.bass);
    gl.uniform1f(u('u_highMult'), params.high);
    gl.uniform1i(u('u_tex'), 0);
    
    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);
    requestAnimationFrame(render);
}

async function start() {
    document.getElementById('startBtn').disabled = true;
    document.getElementById('startBtn').textContent = 'Starting...';
    
    if (!initGL()) return;
    
    try {
        const stream = await navigator.mediaDevices.getUserMedia({
            video: { width: { ideal: 1280 }, height: { ideal: 720 } },
            audio: true
        });
        webcam = document.getElementById('webcam');
        webcam.srcObject = stream;
        await webcam.play();
        initAudio(stream);
        isRunning = true;
        startTime = Date.now();
        document.getElementById('startBtn').textContent = 'Flowing âšœ';
        render();
    } catch(e) {
        alert('Camera/mic error: ' + e.message);
        document.getElementById('startBtn').disabled = false;
        document.getElementById('startBtn').textContent = 'Begin Transformation âšœ';
    }
}

document.getElementById('startBtn').onclick = start;
document.getElementById('fullscreenBtn').onclick = () => {
    const c = document.getElementById('videoContainer');
    if (c.requestFullscreen) c.requestFullscreen();
    else if (c.webkitRequestFullscreen) c.webkitRequestFullscreen();
};

// Sliders
const sliders = {
    flowSlider: ['flow', 'flowVal', '%', 100],
    speedSlider: ['speed', 'speedVal', '%', 100],
    turbSlider: ['turb', 'turbVal', '%', 100],
    scaleSlider: ['scale', 'scaleVal', '%', 100],
    rainbowSlider: ['rainbow', 'rainbowVal', '%', 100],
    layersSlider: ['layers', 'layersVal', '%', 100],
    colorSpeedSlider: ['colorSpeed', 'colorSpeedVal', '%', 100],
    edgeThickSlider: ['edgeThick', 'edgeThickVal', '%', 100],
    magentaSlider: ['magenta', 'magentaVal', '%', 100],
    voidSlider: ['darkVoid', 'voidVal', '%', 100],
    blendSlider: ['blend', 'blendVal', '%', 100],
    audioSlider: ['audio', 'audioVal', '%', 100],
    bassSlider: ['bass', 'bassVal', '%', 100],
    highSlider: ['high', 'highVal', '%', 100]
};

Object.entries(sliders).forEach(([id, [param, valId, suffix, div]]) => {
    document.getElementById(id).oninput = function() {
        params[param] = this.value / div;
        document.getElementById(valId).textContent = this.value + suffix;
    };
});
</script>
</body>
</html>
